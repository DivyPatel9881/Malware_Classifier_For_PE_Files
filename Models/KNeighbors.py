from sklearn.neighbors import KNeighborsClassifier
import os
from joblib import dump, load

def KNeighbors(X_train, y_train, nNeighbors):
    classifier = KNeighborsClassifier(n_neighbors=nNeighbors, metric="minkowski", p=2)
    classifier.fit(X_train, y_train)
    print("Model trained.")
    return classifier

def Persist(classifier):
    if os.path.exists("./trained_models/KNeighbors.joblib"):
        os.remove("./trained_models/KNeighbors.joblib")
    else:
        print("The file does not exist.")
    dump(classifier, "./trained_models/KNeighbors.joblib")
    print("Model stored.")

def Load():
    classifier = load("./trained_models/KNeighbors.joblib")
    print("Model loaded.")
    return classifier