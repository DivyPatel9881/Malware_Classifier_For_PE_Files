import keras
from keras.models import Sequential
from keras.layers import Dense
import

def ANN(X_train, y_train, layers, nodes, batchSize, nbEpoch):
    num_x = len(X_train[0])
    classifier = Sequential()
    classifier.add(Dense(output_dim = nodes,input_dim=num_x, init="uniform", activation="relu"))
    for i in range(layers)
        classifier.add(Dense(output_dim = nodes,init="uniform", activation="relu"))
    classifier.add(Dense(output_dim = 1,init="uniform", activation="sigmoid"))
    classifier.compile(optimizer="adam", loss="binary_crossentropy", metrics=["accuracy"])
    classifier.fit(X_train, y_train, batch_size=batchSize, nb_epoch=nbEpoch)
    return classifier

def Persist(classifier):
    if os.path.exists("../trained_models/ANN.json"):
        os.remove("../trained_models/ANN.json")
        classifier_json = classifier.to_json()
        with open("ANN.json", "w") as json_file:
            json_file.write(classifier_json)
        model.save_weights("ANN.h5")
    else:
        print("The file does not exist.")
    print("Model stored.")

def Load():
    json_file = open('ANN.json', 'r')
    classifier_json = json_file.read()
    json_file.close()
    classifier = classifier_from_json(classifier_json)
    classifier.load_weights("ANN.h5")
    print("Model loaded.")
    return classifier