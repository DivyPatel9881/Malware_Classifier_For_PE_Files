# import operator
# import numpy as np
# import matplotlib.pyplot as plt
import pandas as pd
from sklearn.preprocessing import StandardScaler
# import time
from Accuracy import Accuracy
from getXY import getXY
import sys
from sklearn.model_selection import train_test_split

X, y = getXY(sys.argv[1])

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2, random_state = 0)


from Models.Logistic import Load

# start_time = time.time()
modelLR = Load()
# print("Time Taken to Train: {}".format(time.time() - start_time))

y_pred = modelLR.predict(X_test)
acc=Accuracy(y_test, y_pred)
print('Logistic Reg Accuracy: {}\n'.format(acc))

### ---------------- Random Forest ---------------------- ###

from Models.RandomForest import Load as RLoad

# start_time = time.time()
modelRF = RLoad()
# print("Time Taken to Train: {}".format(time.time() - start_time))

y_pred = modelRF.predict(X_test)

acc = Accuracy(y_test, y_pred)
print('Random Forest Accuracy: {}\n'.format(acc))

### ------------------------ SVM --------------------------- ###

from Models.SVM import Load as SVMLoad

# start_time = time.time()
modelSVM = SVMLoad()
# print("Time Taken to Train: {}".format(time.time() - start_time))

y_pred = modelSVM.predict(X_test)

acc=Accuracy(y_test, y_pred)
print('SVM with rbf Accuracy: {}\n'.format(acc))

### ---------------------- AdaBoost ------------------------- ###

from Models.AdaBoost import Load as AdaLoad

# start_time = time.time()
modelAda = AdaLoad()
# print("Time Taken to Train: {}".format(time.time() - start_time))

y_pred = modelAda.predict(X_test)

acc=Accuracy(y_test, y_pred)
print('AdaBoost Accuracy: {}\n'.format(acc))

### --------------------- Gradient Boosting ---------------- ###

from Models.GradientBoosting import Load as GBLoad

# start_time = time.time()
modelGB = GBLoad()
# print("Time Taken to Train: {}".format(time.time() - start_time))

y_pred = modelGB.predict(X_test)

acc=Accuracy(y_test, y_pred)
print('Gradient Boosting Accuracy: {}\n'.format(acc))

### -------------------- XGBoost --------------------------- ###

from Models.XGBoost import Load as XGBLoad

# start_time = time.time()
modelXGB = XGBLoad()
# print("Time Taken to Train: {}".format(time.time() - start_time))

y_pred = modelXGB.predict(X_test)

acc=Accuracy(y_test, y_pred)
print('XGBoost Accuracy: {}\n'.format(acc))

### --------------------- Decision Tree ------------------------ ###

from Models.DecisionTree import Load as DTLoad

# start_time = time.time()
modelDT = DTLoad()
# print("Time Taken to Train: {}".format(time.time() - start_time))

y_pred = modelDT.predict(X_test)

acc=Accuracy(y_test, y_pred)
print('Decision Tree Accuracy: {}\n'.format(acc))

### -------------------------------------------------------- ###

import features.get_features

while (True):
    print("Enter the file name: ")
    s = input()
    x, y = getXY(s)

    print("Logistic Regression")
    score = modelLR.predict_proba(x)
    print("Malicious: {}".format(score))
    if score <= 0.3:
        print("Verdict: {}".format("Low"))
    elif score <= 0.6:
        print("Verdict: {}".format("Medium"))
    else:
        print("Verdict: {}".format("High"))
    print()

    print("Random Forest")
    score = modelRF.predict_proba(x)
    print("Malicious: {}".format(score))
    if score <= 0.3:
        print("Verdict: {}".format("Low"))
    elif score <= 0.6:
        print("Verdict: {}".format("Medium"))
    else:
        print("Verdict: {}".format("High"))
    print()

    print("SVM")
    score = modelSVM.predict_proba(x)
    print("Malicious: {}".format(score))
    if score <= 0.3:
        print("Verdict: {}".format("Low"))
    elif score <= 0.6:
        print("Verdict: {}".format("Medium"))
    else:
        print("Verdict: {}".format("High"))
    print()

    print("AdaBoost")
    score = modelAda.predict_proba(x)
    print("Malicious: {}".format(score))
    if score <= 0.3:
        print("Verdict: {}".format("Low"))
    elif score <= 0.6:
        print("Verdict: {}".format("Medium"))
    else:
        print("Verdict: {}".format("High"))
    print()

    print("K Nearest Neighbors")
    score = modelKNN.predict_proba(x)
    print("Malicious: {}".format(score))
    if score <= 0.3:
        print("Verdict: {}".format("Low"))
    elif score <= 0.6:
        print("Verdict: {}".format("Medium"))
    else:
        print("Verdict: {}".format("High"))
    print()

    print("Gradient Boosting")
    score = modelGB.predict_proba(x)
    print("Malicious: {}".format(score))
    if score <= 0.3:
        print("Verdict: {}".format("Low"))
    elif score <= 0.6:
        print("Verdict: {}".format("Medium"))
    else:
        print("Verdict: {}".format("High"))
    print()

    print("XGBoost")
    score = modelXGB.predict_proba(x)
    print("Malicious: {}".format(score))
    if score <= 0.3:
        print("Verdict: {}".format("Low"))
    elif score <= 0.6:
        print("Verdict: {}".format("Medium"))
    else:
        print("Verdict: {}".format("High"))
    print()

    print("Decision Tree")
    score = modelDT.predict_proba(x)
    print("Malicious: {}".format(score))
    if score <= 0.3:
        print("Verdict: {}".format("Low"))
    elif score <= 0.6:
        print("Verdict: {}".format("Medium"))
    else:
        print("Verdict: {}".format("High"))
    print()